
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Painel de Controle - Bot Telegram</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Painel completo para gerenciar seu bot do Telegram">
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Bot Panel">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiByeD0iMjQiIGZpbGw9InVybCgjZ3JhZGllbnQwX2xpbmVhcl8xXzEpIi8+CjxwYXRoIGQ9Ik05NiA0OEM3My45IDQ4IDU2IDY1LjkgNTYgODhWMTA0QzU2IDEyNi4xIDczLjkgMTQ0IDk2IDE0NEMxMTguMSAxNDQgMTM2IDEyNi4xIDEzNiAxMDRWODhDMTM2IDY1LjkgMTE4LjEgNDggOTYgNDhaIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI4MCIgY3k9IjgwIiByPSI0IiBmaWxsPSIjNjY3ZWVhIi8+CjxjaXJjbGUgY3g9IjExMiIgY3k9IjgwIiByPSI0IiBmaWxsPSIjNjY3ZWVhIi8+CjxwYXRoIGQ9Ik04OCA5NkgxMDRDMTA2LjIgOTYgMTA4IDk3LjggMTA4IDEwMFYxMDRDMTA4IDEwNi4yIDEwNi4yIDEwOCAxMDQgMTA4SDg4Qzg1LjggMTA4IDg0IDEwNi4yIDg0IDEwNFYxMDBDODQgOTcuOCA4NS44IDk2IDg4IDk2WiIgZmlsbD0iIzY2N2VlYSIvPgo8ZGVmcz4KPGxpbmVhckdyYWRpZW50IGlkPSJncmFkaWVudDBfbGluZWFyXzFfMSIgeDE9IjAiIHkxPSIwIiB4Mj0iMTkyIiB5Mj0iMTkyIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wIHN0b3AtY29sb3I9IiM2NjdlZWEiLz4KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjNzY0YmEyIi8+CjwvbGluZWFyR3JhZGllbnQ+CjwvZGVmcz4KPC9zdmc+">
    
    <link href="style.css" rel="stylesheet" type="text/css" />
</head>
<body>
    <div class="container">
        <header>
            <h1>ü§ñ Painel de Controle do Bot</h1>
            <div class="status" id="botStatus">
                <span class="status-indicator offline"></span>
                <span>Bot Offline</span>
            </div>
        </header>

        <div class="panel-grid">
            <!-- Bot Control Section -->
            <section class="panel-section">
                <h2>Controle do Bot</h2>
                <div class="control-buttons">
                    <button id="startBot" class="btn btn-success">Iniciar Bot</button>
                    <button id="stopBot" class="btn btn-danger">Parar Bot</button>
                    <button id="restartBot" class="btn btn-warning">Reiniciar Bot</button>
                </div>
                <div class="bot-info">
                    <p><strong>Token:</strong> <span id="tokenDisplay">7550422055:AAF***</span></p>
                    <p><strong>Usu√°rios Ativos:</strong> <span id="activeUsers">0</span></p>
                </div>
            </section>

            <!-- Messages Configuration -->
            <section class="panel-section">
                <h2>Configura√ß√£o de Mensagens</h2>
                <div class="message-config">
                    <label for="welcomeMessage">Mensagem de Boas-vindas:</label>
                    <textarea id="welcomeMessage" placeholder="Digite a mensagem de boas-vindas...">Ol√°! Bem-vindo ao nosso bot! üëã</textarea>
                    
                    <label for="helpMessage">Mensagem de Ajuda:</label>
                    <textarea id="helpMessage" placeholder="Digite a mensagem de ajuda...">Comandos dispon√≠veis:
/start - Iniciar conversa
/help - Mostrar ajuda
/config - Configura√ß√µes</textarea>
                    
                    <button id="saveMessages" class="btn btn-primary">Salvar Mensagens</button>
                </div>
            </section>

            <!-- Automatic Messages -->
            <section class="panel-section">
                <h2>Mensagens Autom√°ticas</h2>
                <div class="auto-messages">
                    <div class="auto-message-item">
                        <label for="autoInterval">Intervalo (minutos):</label>
                        <input type="number" id="autoInterval" value="60" min="1">
                    </div>
                    <div class="auto-message-item">
                        <label for="autoMessage">Mensagem Autom√°tica:</label>
                        <textarea id="autoMessage" placeholder="Mensagem que ser√° enviada automaticamente...">Lembre-se de verificar nossas atualiza√ß√µes! üì¢</textarea>
                    </div>
                    <div class="auto-message-controls">
                        <button id="enableAutoMessages" class="btn btn-success">Ativar</button>
                        <button id="disableAutoMessages" class="btn btn-danger">Desativar</button>
                    </div>
                    <p class="status-text">Status: <span id="autoMessageStatus">Desativado</span></p>
                </div>
            </section>

            <!-- Statistics -->
            <section class="panel-section">
                <h2>Estat√≠sticas</h2>
                <div class="stats">
                    <div class="stat-item">
                        <span class="stat-number" id="totalMessages">0</span>
                        <span class="stat-label">Mensagens Enviadas</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="totalUsers">0</span>
                        <span class="stat-label">Total de Usu√°rios</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="todayMessages">0</span>
                        <span class="stat-label">Mensagens Hoje</span>
                    </div>
                </div>
            </section>

            <!-- Image Upload -->
            <section class="panel-section">
                <h2>Enviar Imagem</h2>
                <div class="image-upload">
                    <input type="file" id="imageFile" accept="image/*" style="margin-bottom: 10px;">
                    <input type="text" id="imageCaption" placeholder="Legenda da imagem (opcional)" style="margin-bottom: 10px; width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px;">
                    <div class="image-controls">
                        <button id="sendToAll" class="btn btn-primary">Enviar para Todos</button>
                        <button id="sendToUser" class="btn btn-secondary">Enviar para Usu√°rio Espec√≠fico</button>
                    </div>
                    <input type="text" id="specificUserId" placeholder="ID do usu√°rio" style="margin-top: 10px; width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; display: none;">
                </div>
            </section>

            <!-- Conversation Flow -->
            <section class="panel-section full-width">
                <h2>Fluxo de Conversa</h2>
                <div class="conversation-flow">
                    <div class="flow-controls">
                        <button id="addFlowStep" class="btn btn-primary">Adicionar Etapa</button>
                        <button id="saveFlow" class="btn btn-success">Salvar Fluxo</button>
                        <button id="resetFlow" class="btn btn-danger">Resetar Fluxo</button>
                    </div>
                    <div id="flowSteps" class="flow-steps">
                        <!-- Etapas do fluxo ser√£o adicionadas aqui -->
                    </div>
                </div>
            </section>

            <!-- Broadcast Messages -->
            <section class="panel-section">
                <h2>Enviar Mensagem em Massa</h2>
                <div class="broadcast">
                    <textarea id="broadcastMessage" placeholder="Digite a mensagem para enviar a todos os usu√°rios..."></textarea>
                    <button id="sendBroadcast" class="btn btn-primary">Enviar para Todos</button>
                </div>
            </section>

            <!-- Custom Commands -->
            <section class="panel-section">
                <h2>Comandos Personalizados</h2>
                <div class="custom-commands">
                    <div class="command-input">
                        <input type="text" id="commandName" placeholder="Nome do comando (ex: /precos)">
                        <textarea id="commandResponse" placeholder="Resposta do comando..."></textarea>
                        <button id="addCommand" class="btn btn-primary">Adicionar Comando</button>
                    </div>
                    <div id="commandsList" class="commands-list"></div>
                </div>
            </section>

            <!-- Scheduled Messages -->
            <section class="panel-section">
                <h2>Mensagens Agendadas</h2>
                <div class="scheduled-messages">
                    <input type="datetime-local" id="scheduleTime">
                    <textarea id="scheduledMessage" placeholder="Mensagem agendada..."></textarea>
                    <select id="scheduleTarget">
                        <option value="all">Todos os usu√°rios</option>
                        <option value="specific">Usu√°rio espec√≠fico</option>
                    </select>
                    <input type="text" id="scheduleUserId" placeholder="ID do usu√°rio" style="display: none;">
                    <button id="scheduleMessage" class="btn btn-primary">Agendar Mensagem</button>
                    <div id="scheduledList" class="scheduled-list"></div>
                </div>
            </section>

            <!-- Content Filter -->
            <section class="panel-section">
                <h2>Filtro de Conte√∫do</h2>
                <div class="content-filter">
                    <label>Palavras Bloqueadas:</label>
                    <textarea id="blockedWords" placeholder="Digite palavras proibidas separadas por v√≠rgula..."></textarea>
                    <div class="filter-options">
                        <label><input type="checkbox" id="autoDelete"> Deletar mensagens automaticamente</label>
                        <label><input type="checkbox" id="warnUser"> Avisar usu√°rio</label>
                        <label><input type="checkbox" id="banUser"> Banir usu√°rio ap√≥s 3 avisos</label>
                    </div>
                    <button id="saveFilter" class="btn btn-primary">Salvar Filtros</button>
                </div>
            </section>

            <!-- Analytics Dashboard -->
            <section class="panel-section full-width">
                <h2>Dashboard Anal√≠tico</h2>
                <div class="analytics-dashboard">
                    <div class="charts-container">
                        <div class="chart-item">
                            <h3>Mensagens por Hora</h3>
                            <canvas id="messagesChart" width="400" height="200"></canvas>
                        </div>
                        <div class="chart-item">
                            <h3>Usu√°rios Ativos</h3>
                            <canvas id="usersChart" width="400" height="200"></canvas>
                        </div>
                        <div class="chart-item">
                            <h3>An√°lise de Sentimentos</h3>
                            <div id="sentimentAnalysis" class="sentiment-display">
                                <div class="sentiment-item">
                                    <span class="sentiment-label">Positivo:</span>
                                    <span class="sentiment-value" id="positiveCount">0</span>
                                </div>
                                <div class="sentiment-item">
                                    <span class="sentiment-label">Neutro:</span>
                                    <span class="sentiment-value" id="neutralCount">0</span>
                                </div>
                                <div class="sentiment-item">
                                    <span class="sentiment-label">Negativo:</span>
                                    <span class="sentiment-value" id="negativeCount">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- AI Response System -->
            <section class="panel-section">
                <h2>Respostas Inteligentes</h2>
                <div class="ai-responses">
                    <label><input type="checkbox" id="enableAI"> Ativar Respostas IA</label>
                    <textarea id="aiPrompt" placeholder="Configurar personalidade da IA...">Voc√™ √© um assistente prestativo e amig√°vel. Responda de forma educada e √∫til.</textarea>
                    <div class="ai-settings">
                        <label>Confian√ßa m√≠nima: <input type="range" id="aiConfidence" min="0" max="100" value="70"></label>
                        <span id="confidenceValue">70%</span>
                    </div>
                    <button id="saveAI" class="btn btn-primary">Salvar Configura√ß√µes IA</button>
                </div>
            </section>

            <!-- Backup System -->
            <section class="panel-section">
                <h2>Backup & Restaura√ß√£o</h2>
                <div class="backup-system">
                    <div class="backup-controls">
                        <button id="createBackup" class="btn btn-success">Criar Backup</button>
                        <button id="downloadBackup" class="btn btn-primary">Download Backup</button>
                    </div>
                    <div class="restore-controls">
                        <input type="file" id="backupFile" accept=".json">
                        <button id="restoreBackup" class="btn btn-warning">Restaurar Backup</button>
                    </div>
                    <div id="backupStatus" class="backup-status"></div>
                </div>
            </section>

            <!-- Button Management -->
            <section class="panel-section">
                <h2>Gerenciamento de Bot√µes</h2>
                <div class="button-management">
                    <div class="button-creator">
                        <h3>Criar Novo Bot√£o</h3>
                        <div class="button-config">
                            <div class="button-input-group">
                                <label>Texto do Bot√£o:</label>
                                <input type="text" id="buttonText" placeholder="Ex: Contato">
                            </div>
                            <div class="button-input-group">
                                <label>Tipo de Resposta:</label>
                                <select id="buttonResponseType">
                                    <option value="text">Enviar Texto</option>
                                    <option value="url">Abrir URL</option>
                                    <option value="callback">A√ß√£o Personalizada</option>
                                </select>
                            </div>
                            <div class="button-input-group">
                                <label>Conte√∫do da Resposta:</label>
                                <textarea id="buttonResponse" placeholder="Digite o texto ou URL..."></textarea>
                            </div>
                            <div class="button-input-group">
                                <label>Comando Associado:</label>
                                <input type="text" id="buttonCommand" placeholder="Ex: /contato (opcional)">
                            </div>
                            <button id="addButton" class="btn btn-primary">Adicionar Bot√£o</button>
                        </div>
                    </div>
                    
                    <div class="button-groups">
                        <h3>Grupos de Bot√µes</h3>
                        <div class="group-creator">
                            <input type="text" id="groupName" placeholder="Nome do grupo">
                            <button id="createGroup" class="btn btn-secondary">Criar Grupo</button>
                        </div>
                        <div id="buttonGroups" class="button-groups-list"></div>
                    </div>
                    
                    <div class="button-test">
                        <h3>Testar Bot√µes</h3>
                        <div class="test-controls">
                            <select id="testGroup">
                                <option value="">Selecione um grupo</option>
                            </select>
                            <button id="testButtons" class="btn btn-warning">Enviar Teste</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Menu Management -->
            <section class="panel-section full-width">
                <h2>üçΩÔ∏è Gerenciamento de Card√°pio</h2>
                <div class="menu-management">
                    <div class="menu-creator">
                        <h3>Criar Item do Card√°pio</h3>
                        <div class="menu-form">
                            <div class="menu-input-group">
                                <label>Nome do Item:</label>
                                <input type="text" id="menuItemName" placeholder="Ex: Pizza Margherita">
                            </div>
                            <div class="menu-input-group">
                                <label>Descri√ß√£o:</label>
                                <textarea id="menuItemDescription" placeholder="Descri√ß√£o do item..."></textarea>
                            </div>
                            <div class="menu-input-group">
                                <label>Pre√ßo (R$):</label>
                                <input type="number" id="menuItemPrice" placeholder="0.00" step="0.01" min="0">
                            </div>
                            <div class="menu-input-group">
                                <label>Categoria:</label>
                                <select id="menuItemCategory">
                                    <option value="principais">Pratos Principais</option>
                                    <option value="bebidas">Bebidas</option>
                                    <option value="sobremesas">Sobremesas</option>
                                    <option value="entradas">Entradas</option>
                                    <option value="lanches">Lanches</option>
                                    <option value="pizzas">Pizzas</option>
                                </select>
                            </div>
                            <div class="menu-input-group">
                                <label>Imagem do Item:</label>
                                <input type="file" id="menuItemImage" accept="image/*">
                                <div id="imagePreview" class="image-preview"></div>
                            </div>
                            <div class="menu-input-group">
                                <label>Status:</label>
                                <select id="menuItemStatus">
                                    <option value="disponivel">Dispon√≠vel</option>
                                    <option value="indisponivel">Indispon√≠vel</option>
                                    <option value="promocao">Em Promo√ß√£o</option>
                                </select>
                            </div>
                            <button id="addMenuItem" class="btn btn-primary">Adicionar Item</button>
                        </div>
                    </div>
                    
                    <div class="menu-categories">
                        <h3>Card√°pio por Categorias</h3>
                        <div class="category-tabs">
                            <button class="category-tab active" data-category="all">Todos</button>
                            <button class="category-tab" data-category="principais">Principais</button>
                            <button class="category-tab" data-category="bebidas">Bebidas</button>
                            <button class="category-tab" data-category="sobremesas">Sobremesas</button>
                            <button class="category-tab" data-category="entradas">Entradas</button>
                            <button class="category-tab" data-category="lanches">Lanches</button>
                            <button class="category-tab" data-category="pizzas">Pizzas</button>
                        </div>
                        <div id="menuItems" class="menu-items-grid"></div>
                    </div>
                    
                    <div class="menu-controls">
                        <h3>Controles do Card√°pio</h3>
                        <div class="menu-actions">
                            <button id="sendMenuToAll" class="btn btn-success">Enviar Card√°pio Completo</button>
                            <button id="sendCategoryMenu" class="btn btn-primary">Enviar por Categoria</button>
                            <select id="categorySelect">
                                <option value="">Selecione uma categoria</option>
                                <option value="principais">Pratos Principais</option>
                                <option value="bebidas">Bebidas</option>
                                <option value="sobremesas">Sobremesas</option>
                                <option value="entradas">Entradas</option>
                                <option value="lanches">Lanches</option>
                                <option value="pizzas">Pizzas</option>
                            </select>
                            <button id="createMenuButtons" class="btn btn-warning">Criar Bot√µes de Pedido</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Language Settings -->
            <section class="panel-section">
                <h2>Configura√ß√µes de Idioma</h2>
                <div class="language-settings">
                    <select id="botLanguage">
                        <option value="pt">Portugu√™s</option>
                        <option value="en">English</option>
                        <option value="es">Espa√±ol</option>
                        <option value="fr">Fran√ßais</option>
                    </select>
                    <button id="saveLanguage" class="btn btn-primary">Salvar Idioma</button>
                    <div class="auto-translate">
                        <label><input type="checkbox" id="autoTranslate"> Auto-traduzir mensagens</label>
                    </div>
                </div>
            </section>

            <!-- Logs -->
            <section class="panel-section full-width">
                <h2>Logs do Bot</h2>
                <div class="logs-container">
                    <div class="log-filters">
                        <select id="logFilter">
                            <option value="all">Todos os logs</option>
                            <option value="info">Informa√ß√µes</option>
                            <option value="warning">Avisos</option>
                            <option value="error">Erros</option>
                        </select>
                        <button id="exportLogs" class="btn btn-secondary">Exportar Logs</button>
                    </div>
                    <div id="logs" class="logs"></div>
                    <button id="clearLogs" class="btn btn-secondary">Limpar Logs</button>
                </div>
            </section>
        </div>
    </div>

    <script src="script.js"></script>
    
    <!-- PWA Installation Script -->
    <script>
        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('SW registered: ', registration);
                    })
                    .catch(function(registrationError) {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }

        // PWA Install Prompt
        let deferredPrompt;
        const installBtn = document.createElement('button');
        installBtn.textContent = 'üì± Instalar App';
        installBtn.className = 'btn btn-primary install-btn';
        installBtn.style.display = 'none';
        installBtn.style.position = 'fixed';
        installBtn.style.bottom = '20px';
        installBtn.style.right = '20px';
        installBtn.style.zIndex = '1000';
        installBtn.style.borderRadius = '50px';
        installBtn.style.padding = '12px 20px';
        installBtn.style.boxShadow = '0 4px 15px rgba(0,0,0,0.3)';
        document.body.appendChild(installBtn);

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installBtn.style.display = 'block';
        });

        installBtn.addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                deferredPrompt = null;
                installBtn.style.display = 'none';
            }
        });

        window.addEventListener('appinstalled', () => {
            installBtn.style.display = 'none';
            console.log('PWA foi instalada');
        });

        // Prevent zoom on double tap for iOS
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function (event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);

        // Disable pinch zoom
        document.addEventListener('gesturestart', function (e) {
            e.preventDefault();
        });

        document.addEventListener('gesturechange', function (e) {
            e.preventDefault();
        });

        document.addEventListener('gestureend', function (e) {
            e.preventDefault();
        });
    </script>
</body>
</html>
